/* Base styles & Theming */
:root {
  --font-stack: 'Inter', system-ui, Avenir, Helvetica, Arial, sans-serif;
  --bg: #0f1115;
  --bg-alt: #161a21;
  --bg-panel: #1f242c;
  --bg-panel-alt: #262d37;
  --text: #e6e9ef;
  --text-dim: #9aa3b4;
  --accent: #5b8aff;
  --accent-glow: 174 55% 60%;
  --danger: #f45b5b;
  --warn: #f5a524;
  --ok: #5ad48c;
  --radius-s: 4px;
  --radius-m: 10px;
  --radius-l: 18px;
  --shadow-1: 0 4px 12px -2px rgba(0,0,0,.4);
  --shadow-glow: 0 0 0 1px hsla(var(--accent-glow) / .3), 0 0 18px -4px hsla(var(--accent-glow) / .5);
  --transition-fast: .18s cubic-bezier(.4, .2, .2, 1);
}

html[data-theme='light'] {
  --bg: #f5f7fa;
  --bg-alt: #edf1f7;
  --bg-panel: #ffffff;
  --bg-panel-alt: #f2f6fc;
  --text: #1d2430;
  --text-dim: #5a6575;
  --accent: #336dff;
  --danger: #d63031;
  --warn: #e69500;
  --ok: #2eaf62;
  color-scheme: light;
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: var(--font-stack);
  background: radial-gradient(circle at 30% 20%, #1b2230, var(--bg));
  background-attachment: fixed;
  color: var(--text);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

#particles { position: fixed; inset: 0; z-index: -1; }

h1, h2, h3 { line-height: 1.15; margin: 0 0 .6em; font-weight: 600; }
p { margin: 0 0 1em; }

.app-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: .9rem 1.4rem;
  backdrop-filter: blur(14px) saturate(1.2);
  background: linear-gradient(100deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  border-bottom: 1px solid rgba(255,255,255,.06);
}
.app-header h1 { font-size: clamp(1.4rem, 2.5vw, 1.9rem); letter-spacing: .5px; }
.accent { color: var(--accent); text-shadow: 0 0 8px color-mix(in hsl, var(--accent) 70%, transparent); }

.toolbar { display: flex; gap: .5rem; }
button { font-family: inherit; cursor: pointer; }

.ghost-btn, .primary-btn, .secondary-btn, .danger-btn {
  --btn-bg: var(--bg-panel);
  --btn-border: rgba(255,255,255,.08);
  --btn-hover: var(--bg-panel-alt);
  --btn-active: var(--accent);
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: .4ch;
  padding: .55rem .85rem;
  font-size: .9rem;
  border-radius: var(--radius-s);
  background: var(--btn-bg);
  border: 1px solid var(--btn-border);
  color: var(--text);
  transition: background var(--transition-fast), border-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
}
.ghost-btn:hover { background: var(--btn-hover); }
.primary-btn { --btn-bg: var(--accent); --btn-border: var(--accent); color: #fff; font-weight: 600; }
.primary-btn:hover { filter: brightness(1.05); }
.secondary-btn { --btn-bg: var(--bg-panel-alt); }
.danger-btn { --btn-bg: var(--danger); --btn-border: var(--danger); color: #fff; }
.small { font-size: .75rem; padding: .45rem .65rem; }
button:active { transform: translateY(1px); }

.layout { display: grid; gap: 1.2rem; padding: 1.2rem clamp(.8rem, 2.5vw, 2rem); grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
.panel {
  background: linear-gradient(145deg, var(--bg-panel), var(--bg-panel-alt));
  border: 1px solid rgba(255,255,255,.06);
  border-radius: var(--radius-m);
  padding: 1rem 1.1rem 1.2rem;
  position: relative;
  box-shadow: var(--shadow-1);
  overflow: hidden;
}
.panel:before {
  content: "";
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 14% 18%, rgba(255,255,255,.08), transparent 70%);
  opacity: .5;
  pointer-events: none;
}
.panel-title { font-size: 1.05rem; letter-spacing: .5px; text-transform: uppercase; opacity: .85; }

.test-text { font-family: 'JetBrains Mono', 'Courier New', monospace; font-size: 1rem; line-height: 1.55; min-height: 4.5rem; white-space: pre-wrap; word-break: break-word; }
.test-text span { padding: 1px 2px; border-radius: 4px; transition: background .2s; }
.test-text span.current { outline: 1px solid var(--accent); background: rgba(91,138,255,.15); animation: pulse 1.6s ease-in-out infinite; }
.test-text span.correct { color: var(--ok); }
.test-text span.incorrect { color: var(--danger); background: rgba(244,91,91,.15); }

@keyframes pulse { 0%,100% { box-shadow: 0 0 0 0 rgba(91,138,255,.5);} 50% { box-shadow: 0 0 0 6px rgba(91,138,255,0); } }

.input-visualization { display: flex; gap: .35rem; flex-wrap: wrap; min-height: 2.2rem; align-items: center; margin-top: .6rem; }
.key-chip { font-family: 'JetBrains Mono', monospace; font-size: .85rem; padding: .35rem .55rem .32rem; border-radius: 6px; background: var(--bg-alt); border: 1px solid rgba(255,255,255,.07); position: relative; min-width: 1.8rem; text-align: center; }
.key-chip.good { border-color: rgba(90,212,140,.5); color: var(--ok); }
.key-chip.bad { border-color: rgba(244,91,91,.55); color: var(--danger); animation: shake .4s; }
@keyframes shake { 0%,100% { transform: translateX(0); } 20% { transform: translateX(-3px);} 40% { transform: translateX(3px);} 60% { transform: translateX(-2px);} 80% { transform: translateX(2px);} }

.hint { font-size: .75rem; opacity: .65; margin-top: .4rem; }

.suggestion-list { list-style: none; margin: 0 0 1rem; padding: 0; display: flex; flex-wrap: wrap; gap: .5rem; }
.suggestion-list li { background: var(--bg-alt); padding: .5rem .7rem; border-radius: 6px; font-family: 'JetBrains Mono', monospace; font-size: .8rem; letter-spacing: .5px; border: 1px solid rgba(255,255,255,.07); }

.stats-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(90px,1fr)); gap: .7rem .8rem; margin-bottom: .8rem; }
.stat { display: flex; flex-direction: column; align-items: flex-start; gap: .15rem; }
.stat .label { font-size: .65rem; text-transform: uppercase; letter-spacing: 1px; opacity: .6; }
.stat .value { font-size: 1rem; font-weight: 600; }

.history-details { margin-top: .8rem; }
.history-list { list-style: none; margin: .4rem 0 0; padding: 0; max-height: 180px; overflow: auto; font-size: .7rem; display: grid; gap: .35rem; }
.history-list li { padding: .35rem .5rem; background: var(--bg-alt); border-radius: 4px; display: flex; justify-content: space-between; gap: .5rem; }

.app-footer { text-align: center; padding: .9rem; font-size: .7rem; opacity: .6; }
.app-footer a { color: var(--accent); }

/* Dialog */
dialog { border: 1px solid rgba(255,255,255,.15); background: var(--bg-panel); color: var(--text); border-radius: var(--radius-m); padding: 1.3rem 1.4rem 1.5rem; box-shadow: var(--shadow-1), var(--shadow-glow); max-width: 480px; }
dialog::backdrop { backdrop-filter: blur(6px); background: rgba(0,0,0,.4); }

/* Responsive tweaks */
@media (max-width: 640px) {
  .layout { grid-template-columns: 1fr; }
  .panel { padding: .95rem .9rem 1.15rem; }
  .test-text { font-size: .95rem; }
}
